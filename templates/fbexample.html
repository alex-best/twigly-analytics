<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>Twigly Presents: Vanvaas!</title>
    <link href="https://fonts.googleapis.com/css?family=Handlee|Shadows+Into+Light+Two" rel="stylesheet">
    <link rel="stylesheet" href="http://blog.twigly.in:8080/static/css/bootstrap.min.css">
    <link rel="shortcut icon" type="image/png" href='http://twigly.in/assets/images/favicon.png'>
    {% if thisuser %}
      <meta property="og:url" content="http://blog.twigly.in:8080/vanvaas/{{ thisuser.id }}" />
    {% else %}
      <meta property="og:url" content="http://blog.twigly.in:8080/vanvaas" />
    {% end %}
    <meta property="og:type" content="website" />
    {% if thisuser %}
      <meta property="og:title" content="{{ thisuser.name }}'s Vanvaas Team" />
    {% else %}
      <meta property="og:title" content="Twigly Presents Vanvaas!" />
    {% end %}
    {% if thisuser and type=="Their" %}
      <meta property="og:description" content="This is who {{ thisuser.name }} would take along if they had to go for Vanvaas" />

    {% elif thisuser and type=="Your" %}
      <meta property="og:description" content="Check out who I would take along if I had to go for Vanvaas today" />
    {% else %}
      <meta property="og:description" content="Who would you take along if you had to go for Vanvaas today" />
    {% end %}
    <meta property="og:image" content="http://twigly.in/assets/images/vanvaas.jpg" />
    <meta property="fb:app_id" content="{{ facebook_app_id }}" />
    <style type="text/css">
      .friendimage {
        padding: 20px;
      }
      div.polaroid {
          padding: 10px 10px 10px 10px;
          border: 1px solid #BFBFBF;
          background-color: white;
          box-shadow: 5px 5px 5px #aaaaaa;
      }

      div.rotate_right {
          -ms-transform: rotate(7deg); /* IE 9 */
          -webkit-transform: rotate(7deg); /* Safari */
          transform: rotate(7deg);
      }

      div.rotate_left {
          -ms-transform: rotate(-8deg); /* IE 9 */
          -webkit-transform: rotate(-8deg); /* Safari */
          transform: rotate(-8deg);
      }
    </style>
  </head>
  <body style="background: url(http://blog.twigly.in:8080/static/img/vbackground.jpg) no-repeat fixed center; background-size: cover;">
    <div class="container">
      <div class="row" style="text-align: center; color: #ffffff;">
        <span style="font-family: 'Shadows Into Light Two', cursive; font-size: 2em;">Twigly Presents</span><br>
        <span style="font-family: 'Shadows Into Light Two', cursive; font-size: 3em;">Vanvaas</span><br>
      </div>
      {% if not thisuser %}
        <div class="row" style="text-align: center; font-family: 'Handlee', cursive; margin-top: 20px; font-size: 2em; color: #FFFFFF;">
          <div class="col-xs-12">
            Let us help you figure out who you should take along with you if you had to go for a  Vanvaas.
          </div>
        </div>
        <div class="row" style="text-align: center; margin-top: 20px;">
          <fb:login-button autologoutlink="true" scope="public_profile,email,user_posts"></fb:login-button>
        </div>
        </div>
      {% end %}
      {% if thisuser %}
        <div class="row" style="text-align: center; font-family: 'Handlee', cursive; margin-top: 20px;">
          
          {% if type=="Your" %}
            <div class="col-xs-12" style="font-size: 1.5em; margin-bottom: 15px; color: #ffffff;">Hey {{ escape(thisuser.name) }}</div>
          {% end %}
          <div class="hidden-xs hidden-sm col-md-4"></div>
          <div class="col-xs-12 col-md-4">
            <div class="col-xs-6" style="text-align: center;">
              <div class="polaroid rotate_left">
                <img src="https://graph.facebook.com/{{ thisuser.id }}/picture?type=square&height=100"/>
              </div>
            </div>
            <div class="col-xs-6" style="text-align: center;">
              <div class="polaroid rotate_right">
                <img src="http://blog.twigly.in:8080/static/img/v1.jpg" style="height: 100px;" />
              </div>
            </div>
          </div>
          <div class="hidden-xs hidden-sm col-md-4"></div>
          <div class="col-xs-12" style="text-align: center; font-size: 1.5em; margin-top: 15px; color: #FFFFFF;">
            Welcome to Twigly Vanvaas. 
            {% if type=="Your" and (len(commentsresult) > 0 or len(reactionsresult) > 0) %}
              Here are some suggestions for your Vanvaas Team based on your interactions on Facebook.
            {% end %}
            {% if type=="Their" %}
              Here are our suggestions for {{ escape(thisuser.name) }}'s Vanvaas Team based on their interactions on Facebook.
            {% end %}
          </div>
        </div>
        {% if len(reactionsresult) > 0 %}
          <div class="row" style="margin-top: 20px;">
            {% for reaction in reactionsresult %}
              <div class="col-xs-12 col-md-4" style="text-align: center; font-size: 1.5em; font-family: 'Handlee', cursive;">
                <div class="col-xs-12" style="color: #ffffff; margin-bottom: 10px; text-align: center;">
                  {{ type }} {{ reaction["character"] }} could be {{ reaction["name"] }}
                </div>
                <div class="col-xs-6">
                  <div class="polaroid rotate_left">
                    <img src='http://blog.twigly.in:8080/static/img/{{ reaction["image"] }}' style="height: 100px;">
                  </div>
                </div>
                <div class="col-xs-6">
                  <div class="polaroid rotate_right">
                    <img src='https://graph.facebook.com/{{ reaction["id"] }}/picture?type=square&height=100' style="height: 100px;">
                  </div>
                </div>
                <div class="col-xs-12" style="text-align: center; font-family: sans-serif; color: #ffffff; font-size: 13px; margin-top: 10px;">
                  {{ reaction["description"] }}
                </div>
              </div>
            {% end %}
          </div>
        {% end %}
        {% if len(commentsresult) > 0 %}
          <div class="row" style="margin-top: 20px;">
            {% for comment in commentsresult %}
              <div class="col-xs-12 col-md-4" style="text-align: center; font-size: 1.5em; font-family: 'Handlee', cursive;">
                <div class="col-xs-12" style="color: #ffffff; margin-bottom: 10px; text-align: center;">
                  {{ type }} {{ comment["character"] }} could be {{ comment["name"] }}
                </div>
                <div class="col-xs-6">
                  <div class="polaroid rotate_left">
                    <img src='http://blog.twigly.in:8080/static/img/{{ comment["image"] }}' style="height: 100px;">
                  </div>
                </div>
                <div class="col-xs-6">
                  <div class="polaroid rotate_right">
                    <img src='https://graph.facebook.com/{{ comment["id"] }}/picture?type=square&height=100' style="height: 100px;">
                  </div>
                </div>
                <div class="col-xs-12" style="text-align: center; font-family: sans-serif; color: #ffffff; font-size: 13px; margin-top: 10px;">
                  {{ comment["description"] }}
                </div>
              </div>
            {% end %}
          </div>
        {% end %}
        {% if len(commentsresult) == 0 and len(reactionsresult) == 0 %}
          <div class="row" style="margin-top: 20px;">
            <div class="col-xs-12" style="color: #ffffff; margin-bottom: 10px; text-align: center;">
              We need access to your posts to show our suggestions for who you can take along for your Vanvaas. Please login again, and this time give us access to your posts. We will never post on your behalf, nor store your posts.
            </div>
          </div>
        {% end %}
        <div class="col-xs-12" style="text-align: center; margin: 15px 0 30px 0;">
          <div style="width: 50%; display: inline-block; text-align: center; background: rgba(255,255,255,0.5); padding: 20px 0 20px 0;">
            <div class="fb-share-button" data-href="http://twigly.in/vanvaas/{{ thisuser.id }}" data-layout="button" data-size="large" data-mobile-iframe="true"><a class="fb-xfbml-parse-ignore" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Ftwigly.in%2Fvanvaas%2F{{ thisuser.id }}">Share</a></div>
            <fb:login-button autologoutlink="true" scope="public_profile,email,user_posts"></fb:login-button>
          </div>
        </div>
      {% end %}
    </div>

    <div id="fb-root"></div>
    <script>
      window.fbAsyncInit = function() {
        FB.init({appId: '{{ facebook_app_id }}', status: true,
                 cookie: true, xfbml: true});
        FB.Event.subscribe('{% if thisuser %}auth.logout{% else %}auth.login{% end %}', function(response) {
          window.location.reload();
        });
      };
      (function() {
        var e = document.createElement('script');
        e.type = 'text/javascript';
        e.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';
        e.async = true;
        document.getElementById('fb-root').appendChild(e);
      }());
    </script>
  </body>
</html>